# Debug configuration for ecommerce-catalog-service
# Usage: skaffold dev or helm upgrade -f values.local.yaml -f values.debug.yaml

debugPort: 2345
command: ["/dlv"]
args:
  - "exec"
  - "/server"
  - "--listen=:2345"
  - "--headless=true"
  - "--api-version=2"
  - "--accept-multiclient"
  - "--continue"

# Startup probe з великим таймаутом для початкового запуску
startupProbe:
  httpGet:
    path: /health/ready
    port: http
  initialDelaySeconds: 5
  periodSeconds: 5
  timeoutSeconds: 5
  failureThreshold: 60  # 60 * 5s = 5 хвилин на старт

# Liveness з великим timeout щоб не вбивало на breakpoint
livenessProbe:
  httpGet:
    path: /health/live
    port: http
  initialDelaySeconds: 30
  periodSeconds: 60
  timeoutSeconds: 10
  failureThreshold: 15  # 15 * 60s = 15 хвилин на breakpoint

# Вимикаємо readiness в дебазі - вона заважає при breakpoints
readinessProbe: {}
