ecommerce-product-service:
  image:
    repository: sokol111/ecommerce-product-service
    tag: "0.0.14"
  ingress:
    enabled: true
    host: ecommerce-product-service.127.0.0.1.nip.io
  env:
    - name: APP_ENV
      value: "dev"
    - name: APP_SERVICE_NAME
      valueFrom:
        fieldRef:
          fieldPath: metadata.labels['app.kubernetes.io/name']
    - name: APP_SERVICE_VERSION
      valueFrom:
        fieldRef:
          fieldPath: metadata.labels['app.kubernetes.io/version']
  initContainers:
    - name: migrate
      image: "sokol111/ecommerce-product-service-migrator:dev"
      command: ["/bin/sh", "-c"]
      args:
        - migrate -path=/migrations -database "mongodb://mongo:27017/product?replicaSet=rs0&w=majority&retryWrites=true&x-advisory-locking=true&x-migrations-collection=schema_migrations" up

ecommerce-category-service:
  image:
    repository: sokol111/ecommerce-category-service
    tag: "0.0.14"
  ingress:
    enabled: true
    host: ecommerce-category-service.127.0.0.1.nip.io
  env:
    - name: APP_ENV
      value: "dev"
    - name: APP_SERVICE_NAME
      valueFrom:
        fieldRef:
          fieldPath: metadata.labels['app.kubernetes.io/name']
    - name: APP_SERVICE_VERSION
      valueFrom:
        fieldRef:
          fieldPath: metadata.labels['app.kubernetes.io/version']
  initContainers:
    - name: migrate
      image: "sokol111/ecommerce-category-service-migrator:dev"
      command: ["/bin/sh", "-c"]
      args:
        - migrate -path=/migrations -database "mongodb://mongo:27017/category?replicaSet=rs0&w=majority&retryWrites=true&x-advisory-locking=true&x-migrations-collection=schema_migrations" up

ecommerce-product-query-service:
  image:
    repository: sokol111/ecommerce-product-query-service
    tag: "0.0.7"
  ingress:
    enabled: true
    host: ecommerce-product-query-service.127.0.0.1.nip.io
  env:
    - name: APP_ENV
      value: "dev"
    - name: APP_SERVICE_NAME
      valueFrom:
        fieldRef:
          fieldPath: metadata.labels['app.kubernetes.io/name']
    - name: APP_SERVICE_VERSION
      valueFrom:
        fieldRef:
          fieldPath: metadata.labels['app.kubernetes.io/version']
  initContainers:
    - name: migrate
      image: "sokol111/ecommerce-product-query-service-migrator:dev"
      command: ["/bin/sh", "-c"]
      args:
        - migrate -path=/migrations -database "mongodb://mongo:27017/product-query?replicaSet=rs0&w=majority&retryWrites=true&x-advisory-locking=true&x-migrations-collection=schema_migrations" up

ecommerce-category-query-service:
  image:
    repository: sokol111/ecommerce-category-query-service
    tag: "0.0.9"
  ingress:
    enabled: true
    host: ecommerce-category-query-service.127.0.0.1.nip.io
  env:
    - name: APP_ENV
      value: "dev"
    - name: APP_SERVICE_NAME
      valueFrom:
        fieldRef:
          fieldPath: metadata.labels['app.kubernetes.io/name']
    - name: APP_SERVICE_VERSION
      valueFrom:
        fieldRef:
          fieldPath: metadata.labels['app.kubernetes.io/version']
  initContainers:
    - name: migrate
      image: "sokol111/ecommerce-category-query-service-migrator:dev"
      command: ["/bin/sh", "-c"]
      args:
        - migrate -path=/migrations -database "mongodb://mongo:27017/category-query?replicaSet=rs0&w=majority&retryWrites=true&x-advisory-locking=true&x-migrations-collection=schema_migrations" up
