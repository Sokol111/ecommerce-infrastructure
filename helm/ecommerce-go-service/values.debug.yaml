# Debug configuration for all services
# Usage: skaffold dev -f skaffold.yaml --profile debug
# Or manually: helm upgrade --install -f values.yaml -f values.debug.yaml ...

ecommerce-product-service:
  nameOverride: ecommerce-product-service
  debugPort: 2345
  command: ["/dlv"]
  args:
    - "exec"
    - "/server"
    - "--listen=:2345"
    - "--headless=true"
    - "--api-version=2"
    - "--accept-multiclient"
    - "--continue"
  # Startup probe з великим таймаутом для початкового запуску
  startupProbe:
    httpGet:
      path: /health/live
      port: 8080
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 30  # 30 * 10s = 5 хвилин на старт
  # Вимикаємо liveness/readiness щоб не вбивало pod під час debug
  livenessProbe: null
  readinessProbe: null

ecommerce-category-service:
  nameOverride: ecommerce-category-service
  debugPort: 2345
  command: ["/dlv"]
  args:
    - "exec"
    - "/server"
    - "--listen=:2345"
    - "--headless=true"
    - "--api-version=2"
    - "--accept-multiclient"
    - "--continue"
  startupProbe:
    httpGet:
      path: /health/live
      port: 8080
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 30
  livenessProbe: null
  readinessProbe: null

ecommerce-product-query-service:
  nameOverride: ecommerce-product-query-service
  debugPort: 2345
  command: ["/dlv"]
  args:
    - "exec"
    - "/server"
    - "--listen=:2345"
    - "--headless=true"
    - "--api-version=2"
    - "--accept-multiclient"
    - "--continue"
  startupProbe:
    httpGet:
      path: /health/live
      port: 8080
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 30
  livenessProbe: null
  readinessProbe: null

ecommerce-category-query-service:
  nameOverride: ecommerce-category-query-service
  debugPort: 2345
  command: ["/dlv"]
  args:
    - "exec"
    - "/server"
    - "--listen=:2345"
    - "--headless=true"
    - "--api-version=2"
    - "--accept-multiclient"
    - "--continue"
  startupProbe:
    httpGet:
      path: /health/live
      port: 8080
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 30
  livenessProbe: null
  readinessProbe: null

ecommerce-image-service:
  nameOverride: ecommerce-image-service
  debugPort: 2345
  command: ["/dlv"]
  args:
    - "exec"
    - "/server"
    - "--listen=:2345"
    - "--headless=true"
    - "--api-version=2"
    - "--accept-multiclient"
    - "--continue"
  startupProbe:
    httpGet:
      path: /health/live
      port: 8080
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 30
  livenessProbe: null
  readinessProbe: null
